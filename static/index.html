<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Free2Format - File Converter</title>
    <meta name="description"
        content="Convert any file for free. No login, no limits, no watermark. Supports documents, images, audio, and video formats.">
    <meta name="keywords" content="file converter, free, pdf, docx, jpg, mp3, mp4, online converter">
    <link rel="stylesheet" href="/static/styles.css">
    <link rel="shortcut icon" href="/assets/Icon.ico" type="image/x-icon">
    <!-- Font Awesome CDN for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
        crossorigin="anonymous" referrerpolicy="no-referrer" />

</head>

<body>
    <header>
        <div class="container">
            <div class="logo"><span>Free2</span>Format</div>
            <!-- Mobile right controls -->
            <div class="mobile-header-controls">
                <button id="darkModeToggleMobile" class="dark-mode-toggle" aria-label="Toggle dark mode" type="button">
                    <i id="darkModeIconMobile" class="fa-regular fa-moon"></i>
                </button>
                <div class="hamburger" id="hamburger" aria-label="Open navigation menu" tabindex="0">
                    â˜°
                </div>
            </div>
            <!-- Navigation -->
            <nav id="navMenu" role="navigation" aria-label="Main navigation">
                <ul>
                    <li><a href="#" class="active">Home</a></li>
                    <li><a href="#features">Features</a></li>
                    <li><a href="#formats">Formats</a></li>
                    <li><a href="#footer">Contact</a></li>
                </ul>
                <button id="darkModeToggleDesktop" class="dark-mode-toggle" aria-label="Toggle dark mode" type="button">
                    <i id="darkModeIconDesktop" class="fa-regular fa-moon"></i>
                </button>
            </nav>
        </div>
    </header>

    <main>
        <div class="container">
            <section class="hero">
                <h1>Convert Any File, Fast & Free</h1>
                <div id="total-conversions" style="margin: 18px 0 8px 0; text-align:center;">
                    <h2 style="font-size:1.25rem; font-weight:600; color:var(--primary-color);">
                        <span id="conversionCount" style="font-size:2rem; font-weight:800;">0</span>+ Files Converted
                    </h2>
                </div>
                <p>No login. No limits. No watermark.</p>

                <div class="upload-box" id="dropZone">
                    <div class="upload-icon" aria-hidden="true">
                        <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none"
                            stroke="#9B59FF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            aria-label="Upload icon" role="img">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="17 8 12 3 7 8"></polyline>
                            <line x1="12" y1="3" x2="12" y2="15"></line>
                        </svg>
                    </div>
                    <p>Drag & drop your file here<br><strong>or</strong></p>
                    <label for="fileInput" class="file-input-label">Choose File</label>
                    <input type="file" id="fileInput" aria-label="Choose file to convert" />
                    <p id="fileNamePreview"></p>
                </div>

                <div class="format-select">
                    <select id="fromFormat" disabled>
                        <option value="">From Format (Auto-detected)</option>
                    </select>
                    <div class="arrow-icon" aria-hidden="true">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                            stroke="#9B59FF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                            aria-label="Arrow icon" role="img">
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                            <polyline points="12 5 19 12 12 19"></polyline>
                        </svg>
                    </div>
                    <select id="toFormat">
                        <option value="">To Format</option>
                    </select>
                </div>

                <div id="downloadContainer" class="hidden">
                    <div id="downloadLink"></div>
                </div>

                <!-- Conversion Success Animation -->
                <div id="conversionSuccess">
                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2.5"
                        stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="20 6 11 17 4 10"></polyline>
                    </svg>
                </div>

                <button id="convertBtn" class="convert-btn" disabled>Convert Now</button>

                <div id="progressContainer" class="hidden">
                    <div class="progress-bar">
                        <div id="progressBar"></div>
                    </div>
                    <p id="progressText">Converting... 0%</p>
                </div>
            </section>

            <section class="features" id="features">
                <h2>Why Choose Our File Converter?</h2>
                <div class="feature-grid">
                    <div class="feature-card">
                        <div class="feature-icon" aria-hidden="true">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"
                                fill="none" stroke="#9B59FF" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round" aria-label="Security icon" role="img">
                                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                                <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                            </svg>
                        </div>
                        <h3>Secure Conversion</h3>
                        <p>Your files are encrypted and automatically deleted after conversion.</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon" aria-hidden="true">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"
                                fill="none" stroke="#9B59FF" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round" aria-label="Speed icon" role="img">
                                <circle cx="12" cy="12" r="10"></circle>
                                <polyline points="12 6 12 12 16 14"></polyline>
                            </svg>
                        </div>
                        <h3>Fast Processing</h3>
                        <p>Our advanced algorithms ensure quick conversion of your files.</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon" aria-hidden="true">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"
                                fill="none" stroke="#9B59FF" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round" aria-label="Download icon" role="img">
                                <path d="M3 15v4c0 1.1.9 2 2 2h14a2 2 0 0 0 2-2v-4M17 9l-5 5-5-5M12 12.8V2.5"></path>
                            </svg>
                        </div>
                        <h3>Unlimited Downloads</h3>
                        <p>No restrictions on file size or number of conversions.</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon" aria-hidden="true">
                            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"
                                fill="none" stroke="#9B59FF" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round" aria-label="Device icon" role="img">
                                <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
                                <line x1="8" y1="21" x2="16" y2="21"></line>
                                <line x1="12" y1="17" x2="12" y2="21"></line>
                            </svg>
                        </div>
                        <h3>Works Everywhere</h3>
                        <p>Convert files on any device - desktop, tablet, or mobile.</p>
                    </div>
                </div>
            </section>

            <section class="supported-formats" id="formats">
                <h2>Supported File Formats</h2>
                <div class="format-grid">
                    <div class="format-category">
                        <h3>Document</h3>
                        <ul>
                            <li>PDF</li>
                            <li>DOCX</li>
                            <li>DOC</li>
                            <li>RTF</li>
                            <li>TXT</li>
                        </ul>
                    </div>
                    <div class="format-category">
                        <h3>Image</h3>
                        <ul>
                            <li>JPG</li>
                            <li>PNG</li>
                            <li>GIF</li>
                            <li>BMP</li>
                            <li>TIFF</li>
                        </ul>
                    </div>
                    <div class="format-category">
                        <h3>Audio</h3>
                        <ul>
                            <li>MP3</li>
                            <li>WAV</li>
                            <li>AAC</li>
                            <li>FLAC</li>
                            <li>OGG</li>
                        </ul>
                    </div>
                    <div class="format-category">
                        <h3>Video</h3>
                        <ul>
                            <li>MP4</li>
                            <li>AVI</li>
                            <li>MOV</li>
                            <li>MKV</li>
                            <li>WMV</li>
                        </ul>
                    </div>
                </div>
            </section>
            <!-- Memory Match Game Section -->
            <section class="game-section" id="gameSection">
                <div class="game-header">
                    <h2 class="game-title">Memory Match</h2>
                    <p class="game-subtitle">Match the file type pairs to win!</p>

                    <div class="game-stats">
                        <div class="stat-item">
                            <div class="stat-label">Moves</div>
                            <div class="stat-value" id="moveCount">0</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Time</div>
                            <div class="stat-value" id="timeCount">00:00</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Pairs</div>
                            <div class="stat-value" id="pairCount">0/6</div>
                        </div>
                    </div>
                </div>

                <div class="game-board" id="gameBoard">
                    <!-- Cards will be generated by JavaScript -->
                </div>

                <div class="game-controls">
                    <button class="game-btn" id="resetBtn">New Game</button>
                </div>
            </section>
        </div>
    </main>

    <!-- Win Modal -->
    <div class="win-modal" id="winModal">
        <div class="win-content">
            <h2 class="win-title">ðŸŽ‰ You Won!</h2>
            <div class="win-stats">
                <div class="win-stat">Moves: <span id="finalMoves">0</span></div>
                <div class="win-stat">Time: <span id="finalTime">00:00</span></div>
            </div>
            <button class="game-btn" id="playAgainBtn">Play Again</button>
        </div>
    </div>


    <!-- ----------------------------- FOOTOR ----------------------------- -->
    <footer id="footer" role="contentinfo" aria-label="Footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    Free2<span>Format</span>
                </div>
                <div class="footer-links">
                    <div class="footer-column">
                        <h4>Company</h4>
                        <ul>
                            <li><a href="/static/company/about.html" target="_blank">About Us</a></li>
                            <li><a href="/static/company/contact.html" target="_blank">Contact</a></li>
                            <!-- <li><a href="/static/company/careers.html" target="_blank">Careers</a></li> -->
                        </ul>
                    </div>
                    <div class="footer-column">
                        <h4>Legal</h4>
                        <ul>
                            <li><a href="#" class="legal-link" data-legal="privacy">Privacy Policy</a></li>
                            <li><a href="#" class="legal-link" data-legal="terms">Terms of Service</a></li>
                            <li><a href="#" class="legal-link" data-legal="cookie">Cookie Policy</a></li>
                        </ul>
                    </div>
                    <div class="footer-column">
                        <h4>Help</h4>
                        <ul>
                            <li><a href="/static/help/faq.html" target="_blank">FAQ</a></li>
                            <li><a href="/static/help/faq.html#tutorials" target="_blank">Tutorials</a></li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="copyright">
                &copy; 2025 Free2Format. All rights reserved.
            </div>
        </div>
    </footer>

    <!-- Error Modal: Use for critical errors that require user acknowledgment -->
    <div id="errorModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="errorMessage">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h3>Error</h3>
            <p id="errorMessage"></p>
        </div>
    </div>
    <!-- Toast Notification: Use for minor or quick notifications -->
    <div id="toast" class="toast" role="status" aria-live="polite"></div>

    <!-- Like & Donation Modal -->
    <div id="likeDonationModal" class="modal hidden" role="dialog" aria-modal="true"
        aria-labelledby="likeDonationTitle">
        <div class="modal-content">
            <span class="close-modal" id="closeLikeDonationModal">&times;</span>
            <h3 id="likeDonationTitle">Enjoyed using Free2Format?</h3>
            <p>
                If you liked our website, please consider supporting us!<br>
                Your donation helps keep this service free and ad-free.<br>
                <strong>Thank you for your support!</strong>
            </p>

            <!-- Razorpay Payment Button Embed -->
            <form>
                <script src="https://checkout.razorpay.com/v1/payment-button.js"
                    data-payment_button_id="pl_QY4sYVtObkVfYB" async>
                    </script>
            </form>
        </div>
    </div>


    <!-- Legal Modal Popup -->
    <div id="legalModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="legalModalTitle">
        <div class="modal-content" style="max-width:600px;">
            <span class="close-modal" id="closeLegalModal">&times;</span>
            <h3 id="legalModalTitle">Legal</h3>
            <div id="legalModalBody">
                <!-- Content will be injected by JS -->
            </div>
        </div>
    </div>
    <!-- Welcome Message and Confetti Container -->
    <div id="welcomeMessage" class="welcome-message">
        <div class="message-content">
            <h2>Welcome to Free2Format!</h2>
            <p>We're excited to help you with your file conversions.</p>
            <button id="closeWelcome">Got It!</button>
        </div>
        <div class="confetti-container"></div>
    </div>


    <!-- AI Assistant Floating Widget -->
    <div id="aiAssistantChatBtn" title="Chat with File Assistant" aria-label="Open File Assistant">ðŸ’¬</div>
    <div id="aiAssistantBox" role="dialog" aria-modal="true" aria-label="File Assistant">
        <div id="aiAssistantHeader">
            <span>File Assistant</span>
            <span class="close" id="aiAssistantCloseBtn" title="Close">&times;</span>
        </div>
        <div id="aiAssistantChatLog">
            <!-- Chat messages will appear here -->
        </div>
        <div id="aiAssistantQuestions">
            <!-- Question buttons will be injected here -->
        </div>
    </div>
    <script>
        // filepath: d:\Programing\Programing\File Converter\static\index.html
        (function () {
            // Decision tree for conversational flow
            const assistantTree = {
                start: {
                    message: "ðŸ‘‹ Hi! I'm your File Assistant. How can I help you?",
                    options: [
                        { text: "What can I do on this website?", next: "general_what" },
                        { text: "How do I start converting a file?", next: "general_how" },
                        { text: "Is it safe to upload my files?", next: "general_safe" },
                        { text: "Show more topics", next: "topics" }
                    ]
                },
                topics: {
                    message: "Choose a topic to get started:",
                    options: [
                        { text: "Document Conversion", next: "doc_intro" },
                        { text: "Video Conversion", next: "video_intro" },
                        { text: "Audio Conversion", next: "audio_intro" },
                        { text: "Image Conversion", next: "image_intro" },
                        { text: "File Support & Technical", next: "support_intro" },
                        { text: "Fun questions", next: "fun_intro" },
                        { text: "Back to main", next: "start" }
                    ]
                },
                // General
                general_what: {
                    message: "You can convert documents, images, audio, and video files between many formats. Just upload and go! ðŸš€",
                    options: [
                        { text: "How do I start converting a file?", next: "general_how" },
                        { text: "Is this tool free to use?", next: "general_free" },
                        { text: "Show more topics", next: "topics" }
                    ]
                },
                general_how: {
                    message: "Simply upload your file, choose the output format, and click 'Convert Now'. That's it! ðŸ‘",
                    options: [
                        { text: "Is this tool free to use?", next: "general_free" },
                        { text: "Is it safe to upload my files?", next: "general_safe" },
                        { text: "Show more topics", next: "topics" }
                    ]
                },
                general_free: {
                    message: "Yes, Free2Format is 100% free to use. No hidden fees, no watermarks! ðŸ†“",
                    options: [
                        { text: "Do I need to sign up?", next: "general_signup" },
                        { text: "Show more topics", next: "topics" }
                    ]
                },
                general_signup: {
                    message: "No signup needed! You can convert files instantly without creating an account. ðŸ™Œ",
                    options: [
                        { text: "Is it safe to upload my files?", next: "general_safe" },
                        { text: "Show more topics", next: "topics" }
                    ]
                },
                general_safe: {
                    message: "Your files are processed securely and deleted after conversion. ðŸ”’",
                    options: [
                        { text: "Show more topics", next: "topics" }
                    ]
                },
                // Document Conversion
                doc_intro: {
                    message: "Ask me about document conversion:",
                    options: [
                        { text: "How can I convert a PDF to Word?", next: "doc_pdf2word" },
                        { text: "Can I convert DOCX to PDF?", next: "doc_docx2pdf" },
                        { text: "Does it support Excel files?", next: "doc_excel" },
                        { text: "Back to topics", next: "topics" }
                    ]
                },
                doc_pdf2word: {
                    message: "Upload your PDF, select 'Word (DOCX)' as output, and click 'Convert'. Your Word file will be ready in seconds! ðŸ“",
                    options: [
                        { text: "Can I convert DOCX to PDF?", next: "doc_docx2pdf" },
                        { text: "Does it support Excel files?", next: "doc_excel" },
                        { text: "My PDF has images â€” will they be preserved?", next: "doc_pdfimages" },
                        { text: "Back to topics", next: "topics" }
                    ]
                },
                doc_docx2pdf: {
                    message: "Yes! Upload your DOCX file, choose 'PDF' as output, and convert. ðŸ“„âž¡ï¸ðŸ“‘",
                    options: [
                        { text: "Does it support Excel files?", next: "doc_excel" },
                        { text: "Can I convert scanned PDFs to editable text?", next: "doc_scanned" },
                        { text: "Back to topics", next: "topics" }
                    ]
                },
                doc_excel: {
                    message: "Excel (XLSX) support is coming soon! For now, you can convert CSV and some spreadsheet formats. ðŸ“Š",
                    options: [
                        { text: "My PDF has images â€” will they be preserved?", next: "doc_pdfimages" },
                        { text: "Back to topics", next: "topics" }
                    ]
                },
                doc_pdfimages: {
                    message: "Yes, images in your PDF will be preserved in the converted file. ðŸ–¼ï¸",
                    options: [
                        { text: "Can I convert scanned PDFs to editable text?", next: "doc_scanned" },
                        { text: "Back to topics", next: "topics" }
                    ]
                },
                doc_scanned: {
                    message: "If your PDF is scanned, OCR (text recognition) is not supported yet. The output will be an image-based document. ðŸ‘€",
                    options: [
                        { text: "Back to topics", next: "topics" }
                    ]
                },
                // Video Conversion
                video_intro: {
                    message: "Ask me about video conversion:",
                    options: [
                        { text: "How do I convert a video to MP4?", next: "video_mp4" },
                        { text: "Can I compress my video file?", next: "video_compress" },
                        { text: "What video formats do you support?", next: "video_formats" },
                        { text: "Back to topics", next: "topics" }
                    ]
                },
                video_mp4: {
                    message: "Upload your video, select 'MP4' as output, and convert. We support most common video formats! ðŸŽ¬",
                    options: [
                        { text: "Can I compress my video file?", next: "video_compress" },
                        { text: "Does it support large video files?", next: "video_large" },
                        { text: "Back to topics", next: "topics" }
                    ]
                },
                video_compress: {
                    message: "We don't compress videos directly, but converting to MP4 may reduce file size. Try it out! ðŸ“‰",
                    options: [
                        { text: "Does it support large video files?", next: "video_large" },
                        { text: "Back to topics", next: "topics" }
                    ]
                },
                video_large: {
                    message: "You can upload videos up to 100MB. For larger files, try splitting or compressing before upload. ðŸ“¹",
                    options: [
                        { text: "What video formats do you support?", next: "video_formats" },
                        { text: "Back to topics", next: "topics" }
                    ]
                },
                video_formats: {
                    message: "Supported video formats: MP4, AVI, MOV, MKV, WMV, and more. Check the dropdown for the full list! ðŸŽ¥",
                    options: [
                        { text: "Back to topics", next: "topics" }
                    ]
                },
                // Audio Conversion
                audio_intro: {
                    message: "Ask me about audio conversion:",
                    options: [
                        { text: "How can I convert MP3 to WAV?", next: "audio_mp3wav" },
                        { text: "Can I extract audio from a video?", next: "audio_extract" },
                        { text: "Is audio quality reduced after conversion?", next: "audio_quality" },
                        { text: "Back to topics", next: "topics" }
                    ]
                },
                audio_mp3wav: {
                    message: "Upload your MP3, select 'WAV' as output, and click convert. Easy! ðŸŽµ",
                    options: [
                        { text: "Can I extract audio from a video?", next: "audio_extract" },
                        { text: "Back to topics", next: "topics" }
                    ]
                },
                audio_extract: {
                    message: "Yes! Upload your video, select an audio format (like MP3), and we'll extract the audio for you. ðŸŽ§",
                    options: [
                        { text: "Is audio quality reduced after conversion?", next: "audio_quality" },
                        { text: "Back to topics", next: "topics" }
                    ]
                },
                audio_quality: {
                    message: "We aim to keep audio quality high, but some compression may occur depending on the format. ðŸ”Š",
                    options: [
                        { text: "Back to topics", next: "topics" }
                    ]
                },
                // Image Conversion
                image_intro: {
                    message: "Ask me about image conversion:",
                    options: [
                        { text: "How can I convert JPG to PNG?", next: "image_jpgpng" },
                        { text: "Can I resize my image too?", next: "image_resize" },
                        { text: "Do you support WEBP format?", next: "image_webp" },
                        { text: "Back to topics", next: "topics" }
                    ]
                },
                image_jpgpng: {
                    message: "Upload your JPG, select 'PNG' as output, and convert. Done in seconds! ðŸ–¼ï¸",
                    options: [
                        { text: "Can I resize my image too?", next: "image_resize" },
                        { text: "Back to topics", next: "topics" }
                    ]
                },
                image_resize: {
                    message: "Currently, we only convert formats. Image resizing is coming soon! ðŸ“",
                    options: [
                        { text: "Do you support WEBP format?", next: "image_webp" },
                        { text: "Back to topics", next: "topics" }
                    ]
                },
                image_webp: {
                    message: "WEBP support is coming soon. Stay tuned! ðŸ•¸ï¸",
                    options: [
                        { text: "Back to topics", next: "topics" }
                    ]
                },
                // File Support & Technical
                support_intro: {
                    message: "Ask me about file support or technical issues:",
                    options: [
                        { text: "What file formats do you support?", next: "support_formats" },
                        { text: "What's the max upload file size?", next: "support_max" },
                        { text: "How long are files stored?", next: "support_store" },
                        { text: "Will my files be deleted after conversion?", next: "support_delete" },
                        { text: "I'm having trouble uploading â€” what should I do?", next: "support_trouble" },
                        { text: "Back to topics", next: "topics" }
                    ]
                },
                support_formats: {
                    message: "We support PDF, DOCX, DOC, RTF, TXT, JPG, PNG, GIF, BMP, TIFF, MP3, WAV, AAC, FLAC, OGG, MP4, AVI, MOV, MKV, WMV, and more! ðŸ“š",
                    options: [
                        { text: "What's the max upload file size?", next: "support_max" },
                        { text: "Back to topics", next: "topics" }
                    ]
                },
                support_max: {
                    message: "You can upload files up to 100MB each. For larger files, try splitting or compressing first. ðŸ“¦",
                    options: [
                        { text: "How long are files stored?", next: "support_store" },
                        { text: "Back to topics", next: "topics" }
                    ]
                },
                support_store: {
                    message: "Files are stored only during conversion and deleted automatically after. â³",
                    options: [
                        { text: "Will my files be deleted after conversion?", next: "support_delete" },
                        { text: "Back to topics", next: "topics" }
                    ]
                },
                support_delete: {
                    message: "Yes! Files are deleted from our servers after conversion is complete. ðŸ—‘ï¸",
                    options: [
                        { text: "Back to topics", next: "topics" }
                    ]
                },
                support_trouble: {
                    message: "Try refreshing the page, checking your internet, or using a different browser. Still stuck? Contact us! ðŸ› ï¸",
                    options: [
                        { text: "Back to topics", next: "topics" }
                    ]
                },
                // Fun + Friendly
                fun_intro: {
                    message: "Ask me something fun:",
                    options: [
                        { text: "Are you a real assistant? ðŸ¤–", next: "fun_real" },
                        { text: "What's your favorite file type? ðŸ˜„", next: "fun_fav" },
                        { text: "Can you convert my life to a vacation? ðŸ˜‚", next: "fun_vacation" },
                        { text: "Back to topics", next: "topics" }
                    ]
                },
                fun_real: {
                    message: "I'm a virtual assistant, but I'm always here to help you with your files! ðŸ¤–",
                    options: [
                        { text: "What's your favorite file type? ðŸ˜„", next: "fun_fav" },
                        { text: "Back to topics", next: "topics" }
                    ]
                },
                fun_fav: {
                    message: "I love all files equally, but PDFs are pretty cool! ðŸ˜„",
                    options: [
                        { text: "Can you convert my life to a vacation? ðŸ˜‚", next: "fun_vacation" },
                        { text: "Back to topics", next: "topics" }
                    ]
                },
                fun_vacation: {
                    message: "If I could, I'd convert your work into a vacation instantly! ðŸ–ï¸ðŸ˜‚",
                    options: [
                        { text: "Back to topics", next: "topics" }
                    ]
                }
            };

            // DOM
            const chatBtn = document.getElementById('aiAssistantChatBtn');
            const chatBox = document.getElementById('aiAssistantBox');
            const closeBtn = document.getElementById('aiAssistantCloseBtn');
            const chatLog = document.getElementById('aiAssistantChatLog');
            const questionsDiv = document.getElementById('aiAssistantQuestions');

            let isOpen = false;
            let currentNode = "start";

            // Render assistant node (message + options)
            function renderNode(nodeKey, isInitial = false) {
                const node = assistantTree[nodeKey];
                if (!node) return;
                if (isInitial) {
                    chatLog.innerHTML = '';
                }
                addBotMsg(node.message);
                questionsDiv.innerHTML = '';

                // Special handling for topics node
                if (nodeKey === "topics") {
                    node.options.forEach(opt => {
                        if (opt.text.endsWith("topics") || opt.text === "Back to main") return;
                        const btn = document.createElement('button');
                        btn.className = 'ai-question-btn';
                        btn.innerHTML = opt.text;
                        btn.onclick = () => handleOption(opt.next, opt.text);
                        questionsDiv.appendChild(btn);
                    });
                    // Add back button
                    const backBtn = document.createElement('button');
                    backBtn.className = 'ai-question-btn';
                    backBtn.innerHTML = "Back to main";
                    backBtn.onclick = () => handleOption("start", "Back to main");
                    questionsDiv.appendChild(backBtn);
                } else {
                    // Add section title ONCE for intro nodes (FIXED: moved outside the forEach loop)
                    if (nodeKey.endsWith("_intro")) {
                        const section = document.createElement('div');
                        section.className = 'ai-section-title';
                        section.textContent = node.message.replace("Ask me about ", "").replace(":", "");
                        questionsDiv.appendChild(section);
                    }

                    // Add option buttons
                    node.options.forEach(opt => {
                        const btn = document.createElement('button');
                        btn.className = 'ai-question-btn';
                        btn.innerHTML = opt.text;
                        btn.onclick = () => handleOption(opt.next, opt.text);
                        questionsDiv.appendChild(btn);
                    });
                }
                currentNode = nodeKey;
                scrollToBottom();
            }

            // Add bot message
            function addBotMsg(msg) {
                const div = document.createElement('div');
                div.className = 'ai-msg';
                div.innerHTML = `<span style="font-size:1.2em;">ðŸ¤–</span><span class="bubble">${msg}</span>`;
                chatLog.appendChild(div);
                scrollToBottom();
            }

            // Add user message
            function addUserMsg(msg) {
                const div = document.createElement('div');
                div.className = 'user-msg';
                div.innerHTML = `<span class="bubble">${msg}</span>`;
                chatLog.appendChild(div);
                scrollToBottom();
            }

            // Typing animation
            function showTyping() {
                const div = document.createElement('div');
                div.className = 'ai-msg ai-typing';
                div.innerHTML = `<span style="font-size:1.2em;">ðŸ¤–</span><span class="bubble"><span class="typing-dots"><span>.</span><span>.</span><span>.</span></span> Typing...</span>`;
                chatLog.appendChild(div);
                scrollToBottom();
                return div;
            }

            // Scroll to bottom
            function scrollToBottom() {
                setTimeout(() => {
                    chatLog.scrollTop = chatLog.scrollHeight;
                }, 80);
            }

            // Handle option click
            function handleOption(nextKey, userText) {
                addUserMsg(userText);
                questionsDiv.innerHTML = '';
                const typingDiv = showTyping();
                setTimeout(() => {
                    typingDiv.remove();
                    renderNode(nextKey);
                }, 700);
            }

            // Toggle assistant
            function toggleAssistant(open) {
                isOpen = typeof open === "boolean" ? open : !isOpen;
                if (isOpen) {
                    chatBox.classList.add('open');
                    renderNode("start", true);
                } else {
                    chatBox.classList.remove('open');
                }
            }

            // Events
            chatBtn.onclick = () => toggleAssistant(true);
            closeBtn.onclick = () => toggleAssistant(false);

            // Optional: Close on outside click
            document.addEventListener('mousedown', function (e) {
                if (isOpen && !chatBox.contains(e.target) && !chatBtn.contains(e.target)) {
                    toggleAssistant(false);
                }
            });

            // Optional: ESC to close
            document.addEventListener('keydown', function (e) {
                if (isOpen && e.key === "Escape") toggleAssistant(false);
            });

            // Dark mode support
            function updateTheme() {
                const isDark = document.body.classList.contains('dark-mode');
                chatBox.style.background = isDark ? '#232136' : '#fff';
                chatBox.style.color = isDark ? '#e0e0e0' : '#232136';
                chatLog.style.background = isDark ? '#232136' : '#fff';
                Array.from(chatBox.querySelectorAll('.ai-question-btn')).forEach(btn => {
                    btn.style.background = isDark ? '#2d2a40' : '#f5f4fa';
                    btn.style.color = isDark ? '#e0e0e0' : '#232136';
                });
            }
            updateTheme();
            const observer = new MutationObserver(updateTheme);
            observer.observe(document.body, { attributes: true, attributeFilter: ['class'] });

            window.openFileAssistant = () => toggleAssistant(true);
        })();
    </script>


    <!-- Razorpay Checkout script -->
    <script>
        window.addEventListener('load', () => {
            const btn = document.querySelector('a.PaymentButton');
            if (btn) {
                btn.style.backgroundColor = '#9B59FF';
                btn.style.borderRadius = '8px';
                btn.style.padding = '12px 24px';
                btn.style.fontSize = '1.1rem';
                btn.style.fontWeight = 'bold';
                btn.style.color = 'white';
                btn.style.textDecoration = 'none';
                btn.style.display = 'inline-flex';
                btn.style.alignItems = 'center';
                btn.style.boxShadow = '0 4px 8px rgba(0,0,0,0.15)';
                btn.style.transition = 'background-color 0.3s ease';
                btn.style.marginTop = '16px';

                btn.addEventListener('mouseenter', () => {
                    btn.style.backgroundColor = '#9B59FF';
                    btn.style.cursor = 'pointer';
                });
                btn.addEventListener('mouseleave', () => {
                    btn.style.backgroundColor = '#8A48FF';
                });
            }
        });

    </script>
    <script src="/static/script.js" defer></script>
</body>

</html>